    def save_file_as(self):
        current_widget = self.get_current_text_widget()
        if not current_widget:
            QMessageBox.warning(self, "Error", "No hay ninguna pestaña activa para guardar.")
            return

        file_path, _ = QFileDialog.getSaveFileName(self, "Guardar archivo", "", "Archivos de texto (*.txt)")
        if file_path:
            try:
                with open(file_path, 'w', encoding='utf-8') as file:
                    file.write(current_widget.toPlainText())

                # Asociar la pestaña con la nueva ubicación
                index = self.tab_widget.currentIndex()
                self.opened_files[index] = file_path
                self.tab_widget.setTabText(index, os.path.basename(file_path))

                QMessageBox.information(self, "Guardado", f"Archivo guardado en {file_path}.")
            except Exception as e:
                QMessageBox.critical(self, "Error", f"No se pudo guardar el archivo: {str(e)}")
